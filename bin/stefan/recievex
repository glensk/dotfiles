#!/bin/sh

#@ scp aglen@gate.rzg.mpg.de:~/.exchange/archive.tar.bzip2 .
#@ if [ "`hostname`" = "mac" ];then
#@     tar -jxvf archive.tar.bzip2
#@ else
#@     tar --use-compress-program=lbzip2 -xvf archive.tar.bzip2
#@ fi
#@ rm archive.tar.bzip2

filename="sendx.tar.bzip2"
#echo $onhost
#exit
if [ "$onhost" == "daint" ];then
    ### get file when on daint
    mv ~/.exchange/$filename .
else
    ### get file when somewhere else
    address=`grep "address=" $HOME/Dropbox/Albert/scripts/dotfiles/bin/stefan/sendx | tail -1 | sed 's|.*address="||' | sed 's|".*||'`
    echo "address   : $address"
    
    # USE RSYNC SINCE IT CAN DELETE THE FILE AFTERWARDS
    #echo "copy $address:~/.exchange/$filename ."
    rsync --progress --remove-source-files -av -e ssh $address:~/.exchange/$filename . 
fi

#echo ":$1:"
tar=`command -v gtar`
[ "$tar" == "" ] && tar=`command -v tar`
echo "tar       : $tar"
echo 
echo "---------------------- getting following files -----------------"
$tar -xvf $filename 
rm $filename 
